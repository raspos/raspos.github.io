공공기관 경영정보 공개시스템 ALIO 털기
================

공기업
    코드

``` r
library(tidyverse)  
```

    ## ─ Attaching packages ────────────────────────────────────────────── tidyverse 1.2.1 ─

    ## ✔ ggplot2 3.1.1       ✔ purrr   0.3.2  
    ## ✔ tibble  2.1.1       ✔ dplyr   0.8.0.1
    ## ✔ tidyr   0.8.3       ✔ stringr 1.4.0  
    ## ✔ readr   1.3.1       ✔ forcats 0.4.0

    ## ─ Conflicts ─────────────────────────────────────────────── tidyverse_conflicts() ─
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
library(rvest)  
```

    ## Loading required package: xml2

    ## 
    ## Attaching package: 'rvest'

    ## The following object is masked from 'package:purrr':
    ## 
    ##     pluck

    ## The following object is masked from 'package:readr':
    ## 
    ##     guess_encoding

``` r
sheets_2018 <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vRwgSVKHbnwCmyoTSwu74QwAIoJu2ja6X6qPgKCJJaVqfIhPRjiekiYyZQLd4X9XMOX8hQUKFrnN2tf/pub?gid=0&single=true&output=csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   code = col_character(),
    ##   company = col_character()
    ## )

url\_code \<- NULL cros7 \<- NULL cros12 \<- NULL cros13 \<- NULL
cro\_name7 \<- NULL cro\_name12 \<- NULL cro\_name13 \<- NULL

for(i in 1:nrow(sheets)){ url\_code \<-
str\_c(“<http://www.alio.go.kr/popReportTerm.do?apbaId=>”,
sheets\_2018\(code[i], "&reportFormRootNo=2040")  cro <- read_html(url_code) %>%  html_table(fill = T)  print(sheets_2018\)company\[i\])
if(length(cro) \!= 0){ for(t in 1:length(cro)){ cros \<- cro\[\[t\]\]
print(str\_c(t, “번째 테이블”)) if(ncol(cros) == 7){ cros7 \<- rbind(cros7,
cros) for(k in 1:nrow(cros)){ name \<-
as.data.frame(sheets\_2018\(company[i])  cro_name7 <- rbind(cro_name7, name)  }  } else if(ncol(cros) == 12){  cros12 <- rbind(cros12, cros)  for(k in 1:nrow(cros)){  name <- as.data.frame(sheets_2018\)company\[i\])
cro\_name12 \<- rbind(cro\_name12, name)  
} } else if(ncol(cros) == 13){ cros13 \<- rbind(cros13, cros) for(k in
1:nrow(cros)){ name \<- as.data.frame(sheets\_2018$company\[i\])
cro\_name13 \<- rbind(cro\_name13, name)  
} } else { cros \<- cros  
} } } else { cro \<- cro } }

cro7 \<- cbind(cro\_name7, cros7) cro12 \<- cbind(cro\_name12, cros12)
cro13 \<- cbind(cro\_name13, cros13)

colnames(cro7) \<- c(“company”, “category”, “2014”, “2015”, “2016”,
“2017”, “2018”, “2019”) cro7 \<- cro7 %\>% gather(year, num, 3:8)
cro7\(num <- cro7\)num %\>% str\_replace(“\\-”, “0”) %\>%
str\_remove\_all(“,”) cro7\(num <- as.numeric(cro7\)num)
cro7\(num <- round(cro7\)num, 0) cro7\(category <- cro7\)category %\>%
str\_remove\_all(" “) alio\_hire \<- cro7 %\>% filter(category
==”임원및정규직총신규채용") %\>% select(company, year, num)

colnames(cro13) \<- c(“company”, “category”, “2014\_체험형”, “2014\_채용형”,
“2015\_체험형”, “2015\_채용형”, “2016\_체험형”, “2016\_채용형”, “2017\_체험형”,
“2017\_채용형”, “2018\_체험형”, “2018\_채용형”, “2019\_체험형”, “2019\_채용형”) cro13
\<- cro13 %\>% filter(category \!= “구분”) cro13 \<- cro13 %\>%
gather(year\_type, num, 3:14) cro13\(num <- cro13\)num %\>%
str\_replace(“-”, “0”) %\>% str\_remove(“,”)
cro13\(num <- as.numeric(cro13\)num) cro13\(num <- round(cro13\)num, 0)
glimpse(cro13) cro13 \<- cro13 %\>% separate(year\_type, c(“year”,
“type”), sep = "\\\_")

alio\_intern \<- cro13 alio\_intern1 \<- alio\_intern %\>%
group\_by(category, year, type) %\>% summarise(sum = sum(num))
alio\_intern1\(sum <- round(alio_intern1\)sum, 0)

alio\_intern2 \<- alio\_intern %\>% filter(category == “총인턴채용”, type ==
“채용형”) %\>% select(company, year, num)

alio\_intern\_hire \<- left\_join(alio\_hire, alio\_intern2, by =
c(“company”, “year”)) colnames(alio\_intern\_hire) \<- c(“company”,
“year”, “hire\_num”, “intern\_num”) alio\_intern\_hire \<-
alio\_intern\_hire %\>% mutate(rate = (hire\_num / intern\_num) \* 100)
alio\_intern\_hire\(rate <- round(alio_intern_hire\)rate, 0)
alio\_intern\_hire1 \<- alio\_intern\_hire %\>% filter(rate \< 100, year
== 2018) alio\_intern\_hire2 \<- alio\_intern\_hire %\>% filter(rate \<
100, year == 2017)

#### 인턴십 유형별 시각화

ggplot(data = alio\_intern1 %\>% filter(category == “총인턴채용”, year \!=
2019), aes(x = year, y = sum, fill = type)) + geom\_bar(stat =
“identity”, position = “dodge”) + ggtitle(“공공기관 인턴십 by year”) +
geom\_text(aes(label = sum), size = 3, vjust = -0.5, position =
position\_dodge(width = 1)) + theme\_fivethirtyeight(base\_family =
“AppleGothic”)

ggplot(data = alio\_intern1 %\>% filter(category == “여성”, year \!=
2019), aes(x = year, y = sum, fill = type)) + geom\_bar(stat =
“identity”, position = “dodge”) + ggtitle(“공공기관 여성인턴십 by year”) +
geom\_text(aes(label = sum), size = 3, vjust = -0.5, position =
position\_dodge(width = 1)) + theme\_fivethirtyeight(base\_family =
“AppleGothic”)

ggplot(data = alio\_intern1 %\>% filter(category == “장애인”, year \!=
2019), aes(x = year, y = sum, fill = type)) + geom\_bar(stat =
“identity”, position = “dodge”) + ggtitle(“공공기관 장애인인턴십 by year”) +
geom\_text(aes(label = sum), size = 3, vjust = -0.5, position =
position\_dodge(width = 1)) + theme\_fivethirtyeight(base\_family =
“AppleGothic”)
